<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nummi Racing - Focal Point Tool</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            color: #7A9292;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .instructions {
            background: #2c2c2c;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #7A9292;
        }
        
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .image-item {
            background: #2c2c2c;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .image-container {
            position: relative;
            display: inline-block;
            cursor: crosshair;
            border: 2px solid transparent;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .image-container:hover {
            border-color: #7A9292;
        }
        
        .image-container img {
            max-width: 100%;
            height: auto;
            display: block;
        }
        
        .focal-point {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #B3402D;
            border: 2px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            cursor: move;
            z-index: 10;
        }
        
        .focal-point:hover {
            background: #ff4444;
        }
        
        .image-info {
            margin-top: 15px;
            font-size: 14px;
        }
        
        .coordinates {
            background: #1a1a1a;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-family: monospace;
        }
        
        .export-section {
            background: #2c2c2c;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .export-btn {
            background: #7A9292;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        
        .export-btn:hover {
            background: #6a8282;
        }
        
        .export-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
        
        .preview-section {
            background: #2c2c2c;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .preview-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .preview-item {
            text-align: center;
        }
        
        .preview-item img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #7A9292;
        }
        
        .preview-item h4 {
            margin: 10px 0 5px 0;
            color: #7A9292;
        }
        
        .preview-item p {
            margin: 0;
            font-size: 12px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¯ Focal Point Tool - Nummi Racing</h1>
        
        <div class="instructions">
            <h3>How to use:</h3>
            <ol>
                <li><strong>Click on the eyes</strong> of each driver/crew member to set the focal point</li>
                <li>The red dot shows where the focal point is set</li>
                <li>You can drag the focal point to adjust if needed</li>
                <li>Click "Export CSS" to get the CSS for your website</li>
                <li>Preview how images will look with different object-position values</li>
            </ol>
        </div>
        
        <div class="image-grid" id="image-grid">
            <!-- Images will be loaded here -->
        </div>
        
        <div class="export-section">
            <h3>Export Focal Points</h3>
            <button class="export-btn" id="export-css">Export CSS</button>
            <button class="export-btn" id="export-json">Export JSON</button>
            <button class="export-btn" id="clear-all">Clear All</button>
        </div>
        
        <div class="preview-section">
            <h3>Preview Different Sizes</h3>
            <div class="preview-container" id="preview-container">
                <!-- Preview images will be generated here -->
            </div>
        </div>
    </div>

    <script>
        // Sample driver/crew images - replace with your actual image paths
        const images = [
            { name: 'Adam', path: 'images/adam.jpg', focalPoint: null },
            { name: 'Jason', path: 'images/jason.jpg', focalPoint: null },
            { name: 'Joseph', path: 'images/joseph.jpg', focalPoint: null },
            { name: 'Luke', path: 'images/luke.jpg', focalPoint: null },
            { name: 'Manitha', path: 'images/manitha.jpg', focalPoint: null },
            { name: 'Nick', path: 'images/nick.jpg', focalPoint: null },
            { name: 'Patrick', path: 'images/patrick.jpg', focalPoint: null },
            { name: 'Paul', path: 'images/paul.jpg', focalPoint: null },
            { name: 'Vinh', path: 'images/vinh.jpg', focalPoint: null }
        ];

        let focalPoints = {};

        // Initialize the tool
        function initFocalPointTool() {
            const imageGrid = document.getElementById('image-grid');
            
            images.forEach((image, index) => {
                const imageItem = document.createElement('div');
                imageItem.className = 'image-item';
                
                imageItem.innerHTML = `
                    <h3>${image.name}</h3>
                    <div class="image-container" data-index="${index}">
                        <img src="${image.path}" alt="${image.name}" onload="imageLoaded(this, ${index})">
                    </div>
                    <div class="image-info">
                        <div class="coordinates">
                            Focal Point: <span id="coords-${index}">Not set</span>
                        </div>
                        <p>Click on the eyes to set focal point</p>
                    </div>
                `;
                
                imageGrid.appendChild(imageItem);
            });
            
            // Add click event listeners
            imageGrid.addEventListener('click', handleImageClick);
            
            // Initialize export buttons
            document.getElementById('export-css').addEventListener('click', exportCSS);
            document.getElementById('export-json').addEventListener('click', exportJSON);
            document.getElementById('clear-all').addEventListener('click', clearAll);
        }

        // Handle image loading
        function imageLoaded(img, index) {
            // Store image dimensions for calculations
            images[index].width = img.naturalWidth;
            images[index].height = img.naturalHeight;
        }

        // Handle image clicks to set focal points
        function handleImageClick(e) {
            if (e.target.tagName === 'IMG') {
                const container = e.target.parentElement;
                const index = parseInt(container.dataset.index);
                const rect = container.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // Convert to percentage
                const xPercent = Math.round((x / rect.width) * 100);
                const yPercent = Math.round((y / rect.height) * 100);
                
                setFocalPoint(index, xPercent, yPercent);
            }
        }

        // Set focal point for an image
        function setFocalPoint(index, x, y) {
            focalPoints[index] = { x, y };
            images[index].focalPoint = { x, y };
            
            // Update display
            updateFocalPointDisplay(index, x, y);
            updatePreview();
        }

        // Update focal point visual display
        function updateFocalPointDisplay(index, x, y) {
            const container = document.querySelector(`[data-index="${index}"]`);
            const existingPoint = container.querySelector('.focal-point');
            
            if (existingPoint) {
                existingPoint.remove();
            }
            
            const focalPoint = document.createElement('div');
            focalPoint.className = 'focal-point';
            focalPoint.style.left = x + '%';
            focalPoint.style.top = y + '%';
            
            // Make focal point draggable
            makeDraggable(focalPoint, index);
            
            container.appendChild(focalPoint);
            
            // Update coordinates display
            document.getElementById(`coords-${index}`).textContent = `${x}% ${y}%`;
        }

        // Make focal point draggable
        function makeDraggable(element, index) {
            let isDragging = false;
            let startX, startY, startLeft, startTop;
            
            element.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                startLeft = parseFloat(element.style.left);
                startTop = parseFloat(element.style.top);
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const deltaX = e.clientX - startX;
                const deltaY = e.clientY - startY;
                
                const container = element.parentElement;
                const rect = container.getBoundingClientRect();
                
                const newLeft = startLeft + (deltaX / rect.width) * 100;
                const newTop = startTop + (deltaY / rect.height) * 100;
                
                // Constrain to image bounds
                const clampedLeft = Math.max(0, Math.min(100, newLeft));
                const clampedTop = Math.max(0, Math.min(100, newTop));
                
                element.style.left = clampedLeft + '%';
                element.style.top = clampedTop + '%';
                
                // Update focal point data
                focalPoints[index] = { x: Math.round(clampedLeft), y: Math.round(clampedTop) };
                images[index].focalPoint = { x: Math.round(clampedLeft), y: Math.round(clampedTop) };
                
                document.getElementById(`coords-${index}`).textContent = `${Math.round(clampedLeft)}% ${Math.round(clampedTop)}%`;
                
                updatePreview();
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        }

        // Update preview section
        function updatePreview() {
            const previewContainer = document.getElementById('preview-container');
            previewContainer.innerHTML = '';
            
            const sizes = [
                { name: 'Small (150x150)', width: 150, height: 150 },
                { name: 'Medium (300x300)', width: 300, height: 300 },
                { name: 'Large (400x400)', width: 400, height: 400 }
            ];
            
            sizes.forEach(size => {
                const previewItem = document.createElement('div');
                previewItem.className = 'preview-item';
                
                const img = document.createElement('img');
                img.src = images[0].path; // Use first image for preview
                img.style.width = size.width + 'px';
                img.style.height = size.height + 'px';
                
                if (focalPoints[0]) {
                    img.style.objectPosition = `${focalPoints[0].x}% ${focalPoints[0].y}%`;
                }
                
                previewItem.innerHTML = `
                    <h4>${size.name}</h4>
                    <img src="${images[0].path}" alt="Preview" style="width: ${size.width}px; height: ${size.height}px; object-fit: cover; object-position: ${focalPoints[0] ? focalPoints[0].x + '% ' + focalPoints[0].y + '%' : '50% 50%'};">
                    <p>object-position: ${focalPoints[0] ? focalPoints[0].x + '% ' + focalPoints[0].y + '%' : '50% 50%'}</p>
                `;
                
                previewContainer.appendChild(previewItem);
            });
        }

        // Export CSS
        function exportCSS() {
            let css = '/* Focal Point CSS for Nummi Racing Driver/Crew Images */\n\n';
            
            Object.keys(focalPoints).forEach(index => {
                const point = focalPoints[index];
                const image = images[index];
                css += `/* ${image.name} */\n`;
                css += `.driver-card[data-driver="${image.name.toLowerCase()}"] img,\n`;
                css += `.crew-card[data-crew="${image.name.toLowerCase()}"] img {\n`;
                css += `    object-position: ${point.x}% ${point.y}%;\n`;
                css += `}\n\n`;
            });
            
            // Copy to clipboard
            navigator.clipboard.writeText(css).then(() => {
                alert('CSS copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = css;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('CSS copied to clipboard!');
            });
        }

        // Export JSON
        function exportJSON() {
            const data = {
                focalPoints: focalPoints,
                images: images.map((img, index) => ({
                    name: img.name,
                    path: img.path,
                    focalPoint: focalPoints[index] || null
                }))
            };
            
            const json = JSON.stringify(data, null, 2);
            
            // Copy to clipboard
            navigator.clipboard.writeText(json).then(() => {
                alert('JSON data copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = json;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('JSON data copied to clipboard!');
            });
        }

        // Clear all focal points
        function clearAll() {
            if (confirm('Are you sure you want to clear all focal points?')) {
                focalPoints = {};
                images.forEach((img, index) => {
                    img.focalPoint = null;
                    const container = document.querySelector(`[data-index="${index}"]`);
                    const existingPoint = container.querySelector('.focal-point');
                    if (existingPoint) {
                        existingPoint.remove();
                    }
                    document.getElementById(`coords-${index}`).textContent = 'Not set';
                });
                updatePreview();
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initFocalPointTool);
    </script>
</body>
</html>
